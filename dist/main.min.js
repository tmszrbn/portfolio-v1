const navItems=Array.from(document.querySelectorAll('[href^="#"]'));let scrollEvent,lastBodyHeight,lastScroll,navY;const targets=[],navH=document.querySelector("nav").offsetHeight,classDefocused="navbar__item--defocused",mapping=()=>{targets.length=0,navItems.map(e=>{const t=e.getAttribute("href"),s=document.querySelector(t),o=s.offsetTop-s.offsetHeight,c=s.parentElement.offsetTop+s.parentElement.offsetHeight-20;e.addEventListener("click",e=>{e.preventDefault(),scrollToTarget(o+20,document.body.offsetHeight),document.querySelector(`.${classDefocused}`).classList.remove(classDefocused)}),targets.push([e,o,c])}),navY=document.querySelector("header").offsetHeight};window.addEventListener("scroll",e=>{document.querySelector(":focus").classList.add(classDefocused),scrollspy(targets,pageYOffset,navH)});const widthInterval=setInterval(()=>{lastBodyHeight!=document.body.offsetHeight&&(lastBodyHeight=document.body.offsetHeight,mapping());const e=pageYOffset,t=document.querySelector("nav"),s="navbar--hidden";if(navY<e){const o=t.classList.contains(s);scrollhide(lastScroll,e,o),lastScroll=e}else t.classList.contains(s)&&t.classList.remove(s)},500);let currItem;const smoothScroll=(e,t,s=100)=>{const o=pageYOffset,c=Math.abs(o-e);let a=Math.ceil(c/t*s)+.03*s;if(currItem==e&&a<c){o>e+a&&(a=-a);const s=o+window.innerHeight;s+a<t?requestAnimationFrame(()=>{scrollBy(0,a),smoothScroll(e,t)}):t-s<t-e&&scrollBy(0,t-s)}},scrollToTarget=(e,t)=>{currItem=e,smoothScroll(e,t)};let active;const scrollspy=(e,t,s=0,o="navbar__item--active")=>{if(t+innerHeight>=lastBodyHeight)active&&active.classList.remove(o),(active=e[e.length-1][0]).classList.add(o);else if(t>document.querySelector("header").offsetHeight){for(let c of e)if(!c[0].classList.contains(o)&&c[1]<t&&c[2]>t+s){active&&active.classList.remove(o),(active=c[0]).classList.add(o);break}}else active&&active.classList.remove(o)},scrollhide=(e,t,s,o=document.querySelector("nav"),c="navbar--hidden")=>{e!=t&&(s?e>t&&o.classList.remove(c):e<t&&o.classList.add(c))};